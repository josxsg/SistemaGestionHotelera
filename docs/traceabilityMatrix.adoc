= Matriz de Trazabilidad
:doctype: book
:lang: es
:encoding: utf-8
:toclevels: 3
:sectnums:

== Matriz de Trazabilidad (Final Extendida – Hito 6)

Esta matriz conecta exhaustivamente los impulsores arquitectónicos (Drivers), Restricciones (CON) y Preocupaciones (CRN) con las tácticas de diseño, decisiones arquitectónicas y los artefactos resultantes. Integra la cobertura funcional y los requisitos no funcionales de infraestructura y procesos.

[cols="1,3,3,4,1", options="header"]
|===
| ID Driver
| Descripción del Driver (CU, ASR, CON)
| Táctica / Decisión Arquitectónica
| Artefacto(s) de Diseño (Prueba de Cumplimiento)
| Estado

| **ASR-CF-02**
| (Confiabilidad) **Garantía de 0 dobles cobros** a clientes.
| (Táctica: Idempotencia) Asegurar la unicidad de la transacción mediante referencia única.
| * `IPagos.procesarPago` → `PRE-02` (Unicidad).
* `INV-PA-01` (Invariante de Pago).
| Completo

| **ASR-CF-01**
| (Confiabilidad) **Garantía de 0 dobles reservas**.
| (Táctica: Transacción Atómica ACID) Confirmación "todo o nada" (Inventario + Pago).
| * `IGestionReserva.crearReserva` → `POST-03`.
* `INV-GR-02` (Consistencia Reserva–Inventario).
| Completo

| **ASR-AU-01**
| (Auditabilidad) **Trazabilidad de operaciones críticas**.
| (Táctica: Registro Centralizado) Componente transversal `Auditoria`.
| * `IAuditoria` y sus implementaciones.
* `INV-AD-01` (Inmutabilidad del registro).
| Completo

| **ASR-RE-01**
| (Rendimiento) Consulta disponibilidad < 500ms.
| (Táctica: CQRS / Separate Read–Write) Modelo de lectura optimizado.
| * `IConsultaDisponibilidad`.
* `deploymentView.adoc` → Read Replicas.
| Completo

| **ASR-SE-02**
| (Seguridad) **Autorización RBAC**.
| (Táctica: Restringir Acceso) Control de acceso centralizado vía middleware.
| * `IAutorizacion`.
* `securityView.adoc`.
| Completo

| **ASR-SE-01**
| (Seguridad) Aislamiento de datos de Huésped.
| (Táctica: Validación de Propiedad) Verificación explícita de `ownerID`.
| * `IConsultaCliente`, `IGestionReserva`.
| Completo

| **ASR-Consistencia**
| (Consistencia) Datos maestros unificados para 5,000 hoteles.
| (Táctica: Shared Repository / Master Data Management) Fuente única de verdad.
| * `AdministracionCentral`.
* `databaseSchema.sql`.
| Completo

| **ASR-MO-02**
| (Modificabilidad) Cambiar proveedor de pagos.
| (Táctica: Intermediary / Adapter) Aislamiento mediante `IPagos`.
| * `IPagos`.
* `StripeAdapter`, `PayPalAdapter`.
| Completo

| **ASR-DA-02**
| (Disponibilidad) Fallo de pasarela externa.
| (Táctica: Degradación Graciosa) Manejo explícito de estados indeterminados.
| * `IPagos` → `POST-ERR-03`.
| Completo

| **CRN-1 / ASR-CF-01**
| (Preocupación) **Race Conditions** en inventario.
| (Táctica: Locking / Serialize Access) Concurrencia pesimista en BD.
| * `processView.adoc`.
* `ERD` (Bloqueos a nivel de fila).
| Completo

| **CRN-3**
| (Preocupación) **Resiliencia ante picos** (Flash Crowds).
| (Táctica: Introduce Concurrency / Circuit Breaker).
| * `deploymentView.adoc` (Auto-scaling).
* `Resilience Policies`.
| Completo

| **CON-1**
| (Restricción) Persistencia relacional (ACID).
| (Decisión) Uso de RDBMS transaccional.
| * `deploymentView.adoc`.
* `logicalView.adoc`.
| Completo

| **CON-2**
| (Restricción) Solo Web y App Móvil.
| (Decisión) Arquitectura REST stateless.
| * `contextDiagram`.
* `API Specification`.
| Completo

| **CON-5**
| (Restricción) PCI-DSS (no almacenar tarjetas).
| (Táctica: Tokenización) Delegación total a pasarela externa.
| * `domainModel` → `MetodoPago`.
* `dataFlowDiagram`.
| Completo

| **CU-01**
| Consultar disponibilidad.
| (Táctica: Introduce Concurrency / Copies of Data) Uso de réplicas de lectura para aislar consultas del modelo transaccional.
| * `IConsultaDisponibilidad.buscarDisponibilidad`.
* `CommunicationCU1.png`.
| Completo

| **CU-02, CU-03**
| Reservar habitación y realizar pago.
| (Decisión: Orquestación Transaccional) Coordinación de inventario, reserva y pago.
| * `IGestionReserva.crearReserva`.
* `CommunicationCU2.png`, `CommunicationCU3.png`.
| Completo

| **CU-04**
| Cancelar reservación y reembolso.
| (Táctica: Compensating Transaction) Reversión controlada de efectos.
| * `IGestionReserva.cancelarReserva`.
* `IReembolso.procesarReembolso`.
| Completo

| **CU-07, CU-08**
| Check-in y Check-out.
| (Táctica: Manage State / Localize State Changes) Gestión explícita del ciclo de vida de `Estancia`.
| * `IGestionCheckIn`, `IGestionCheckOut`.
* `INV-GE-02`.
| Completo

| **CU-10**
| Registrar consumo.
| (Táctica: Restrict Access by State) Validación de estado antes de permitir cargos.
| * `IConsumos.registrarConsumo`.
* `INV-GE-04`.
| Completo

| **CU-34**
| Rastrear transacción (Auditor).
| (Táctica: Restrict Access / Defer Binding) Interfaz separada para desacoplar acceso administrativo y aplicar seguridad granular.
| * `IConsultaTrazabilidad.rastrearTransaccion`.
| Completo

| **CU-13..33**
| Administración de catálogos, tarifas y personal.
| (Táctica: Localize Changes / Coherencia Semántica) Centralizar reglas de datos maestros para evitar dispersión.
| * `AdministracionCentral`.
* Contrato CRUD Administrativo.
| Completo

| **CON-01**
| (Restricción) Metodología ADD.
| Diseño guiado por atributos de calidad.
| * `architecturalDrivers.adoc`.
* Esta matriz.
| Completo

| **CON-02**
| (Restricción) UML Components / CBSE.
| Identificación, interacción y especificación de componentes.
| * `componentView.adoc`.
* `interfaceDiagram.adoc`.
| Completo

| | **CON-03**
| (Restricción) Modelado: UML 2.x
| Utilizar notación UML estándar para todos los diagramas arquitectónicos.
| * `img/conceptModel/` (Modelo Conceptual)
* `img/contextDiagram/` (Contexto)
* `img/ComponentDiagrams/` (Componentes)
* `img/interfaceDiagram/` (Interfaces)
* `img/CommunicationDiagrams/` (Interacción)
| Completo
|===

== Vista Lógica

Esta vista describe la estructura estática del sistema, su descomposición en elementos lógicos principales y la asignación de responsabilidades funcionales. El objetivo es mostrar cómo la organización del código fuente satisface los impulsores arquitectónicos clave, especialmente la confiabilidad, el rendimiento y la mantenibilidad.

=== Estilo Arquitectónico: Arquitectura en Capas con un Núcleo de Dominio

Para satisfacer los impulsores del sistema, se ha seleccionado un estilo de **Arquitectura en Capas (Layered Architecture)**. Este estilo organiza el sistema en capas horizontales, donde cada una tiene una responsabilidad específica y solo puede comunicarse con la capa inmediatamente inferior. Esta decisión de diseño promueve una fuerte **separación de preocupaciones**, que es fundamental para la **mantenibilidad** a largo plazo.

Dentro de este estilo, el corazón del sistema se modela siguiendo los principios de **Domain-Driven Design (DDD)**, aislando la lógica de negocio compleja en un Núcleo de Dominio explícito.

.Diagrama de Paquetes - Vista Lógica
image::img/logicalView/logical_view.png[Vista Lógica, width=800]

=== Descripción de los Paquetes Lógicos

El sistema se descompone en las siguientes cuatro capas principales:

==== Presentation Layer (Capa de Presentación)
Responsabilidad: Gestionar toda la interacción con los actores del sistema. Es el punto de entrada para todas las solicitudes de usuario.
* **Contribución a la Calidad:** Al aislar la tecnología de la interfaz del resto del sistema, esta capa potencia la **mantenibilidad**.

==== Application Layer (Capa de Aplicación)
Responsabilidad: Orquestar los casos de uso del sistema. No contiene lógica de negocio, sino que actúa como un coordinador.
* **Contribución a la Calidad:** Mantiene los controladores "delgados" y centraliza los flujos de trabajo, mejorando la **mantenibilidad**.

==== Domain Layer (Capa de Dominio)
Responsabilidad: Contener toda la lógica, reglas y estado del negocio. Este es el corazón del software y es completamente independiente.
* **Contribución a la Calidad:** Esta capa es fundamental para la **confiabilidad**. Al aislar la lógica de negocio, podemos probarla exhaustivamente sin depender de la base de datos o la interfaz de usuario.

==== Infrastructure Layer (Capa de Infraestructura)
Responsabilidad: Gestionar todas las comunicaciones con elementos externos y detalles técnicos, como el acceso a la base de datos o la pasarela de pagos.
* **Contribución a la Calidad:** Desacopla el núcleo del sistema de las tecnologías específicas, siendo un factor clave para la **mantenibilidad** y el **rendimiento**.

=== Diagrama de Objetos: Flujo de Confirmación de Reserva

Para clarificar cómo colaboran los elementos de las distintas capas, a continuación se presenta un diagrama de objetos que muestra una "instantánea" de las interacciones durante el proceso de confirmación de una reserva (CU-02 y CU-03).

.Diagrama de Objetos - Confirmación de Reserva
image::img/logicalView/object_diagram_booking.png[Diagrama de Objetos, width=800]

==== Explicación del Flujo de Interacción:
1.  **Entrada (`:BookingController`)**: Un actor envía una solicitud HTTP. Un objeto `BookingController` en la **Capa de Presentación** la recibe.
2.  **Orquestación (`:BookingApplicationService`)**: El controlador invoca al `BookingApplicationService` en la **Capa de Aplicación** para orquestar el caso de uso.
3.  **Lógica de Dominio (`:Reservation`, `:RoomType`)**: El servicio de aplicación utiliza los objetos del **Dominio** para verificar la disponibilidad y aplicar las reglas de negocio, creando una instancia de `Reservation`.
4.  **Infraestructura (`:PaymentGatewayClient`, `:ReservationRepository`)**: El servicio de aplicación utiliza objetos de la **Capa de Infraestructura** para procesar el pago y guardar la reserva en la base de datos.
